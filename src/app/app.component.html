<div class="container">
  <h2>Product Order Form</h2>

  <form [formGroup]="form">
    <table border="1" cellpadding="8" cellspacing="0" width="100%">
      <thead>
        <tr>
          <th>Product</th>
          <th>Quantity</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        <!-- Cast each control to FormGroup -->
        <tr *ngFor="let row of rows.controls; let i = index" [formGroup]="row" [class.locked]="row.value.locked">
          <td>
            <select formControlName="productId" (change)="onProductChange(i)" [disabled]="row.value.locked">
              <option [ngValue]="null">Choose Product</option>
              <option *ngFor="let p of products" [ngValue]="p.id">{{ p.name }}</option>
            </select>
          </td>

          <td>
            <select formControlName="quantity" [disabled]="row.value.locked">
              <option [ngValue]="null">Choose Quantity</option>
              <option *ngFor="let q of [1,2,3,4,5]" [ngValue]="q">{{ q }}</option>
            </select>
          </td>

          <td>
            <button type="button" (click)="onAdd(i)" [disabled]="row.value.locked">Add</button>
            <button *ngIf="row.value.locked" type="button" (click)="onEditRow(i)">Edit</button>
            <button type="button" (click)="onRemoveRow(i)">Remove</button>
          </td>
        </tr>
      </tbody>
    </table>
  </form>

  <div style="margin-top: 20px;">
    <button type="button" (click)="onShowOrder()">Show Order Summary</button>
    <button type="button" (click)="onReadOrder()">What is my order?</button>
  </div>

  <div *ngIf="showSummary" style="margin-top: 20px;">
    <h3>Order Summary</h3>
    <table border="1" cellpadding="8" cellspacing="0" width="100%">
      <thead>
        <tr>
          <th>#</th>
          <th>Product</th>
          <th>Quantity</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of orderItem; let i = index">
          <td>{{ i + 1 }}</td>
          <td>{{ item.productName }}</td>
          <td>{{ item.quantity }}</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
